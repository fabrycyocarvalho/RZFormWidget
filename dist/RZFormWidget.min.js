rz.widgets.FormRenderers={},rz.widgets.RZFormWidgetHelpers={FormWidgetInterface:["fieldCount","getFieldIdAt",{name:"addField",description:"Adiciona um novo campo de entrada de dados ao formulário",friendlyName:"Adicionar campo",params:[{name:"fielddata",friendlyName:"Dados do campo",description:"Dados do campo que será adicionado (ver especificação)",type:"object"}]},"insertField","removeFieldAt","removeFieldById","getValueAt","getValueOf","setValueAt","setValueOf","setValueOfModel","getValueOfModel","getFormData","setFormData","clearFormData","validateForm","validateFieldAt","validateFieldOf"],FormWidgetEventHandlers:["data-changed",{name:"field-added",friendlyName:"Campo adicionado",description:"Evento disparado após a adição de um novo campo ao formulário",params:[{name:"sender",friendlyName:"Remetente",description:"Objeto que provocou o evento",type:"object"},{name:"args",friendlyName:"Informações adicionais",description:"Informações e dados do evento",type:"object"}]}]},rz.widgets.formHelpers={fieldRenderers:{},dataValidators:{},fieldPartRenderers:{},renderDataRows:function(sb,params,renderDataRow){void 0!==params.fields&&params.fields.forEach(function(it,ix){renderDataRow(sb,it,ix)})},renderDataFieldByType:function(sb,field,containerID){this.fieldRenderers[field.type].render(sb,field,containerID)},resolveModelName:function(field,generatedID){var hasGetAndSet=void 0!==rz.widgets.formHelpers.fieldRenderers[field.type].getValue&&void 0!==rz.widgets.formHelpers.fieldRenderers[field.type].setValue;return hasGetAndSet?void 0!==field.model&&null!=field.model.match(/^[a-zA-Z]+[0-9]*(\.[a-zA-Z]+[0-9]*)*$/)?field.model:generatedID+"_data":"***"},getInitialValueData:function(field){var data=field.initialValue;return void 0===data?"":"object"==typeof data?"object-data:["+btoa(JSON.stringify(data))+"]":data},createFieldRenderer:function(n,d){this.fieldRenderers[n]=d},createFieldPartRenderer:function(n,d,t){var name=void 0===t?n:t+"."+n;this.fieldPartRenderers[name]=d},getFieldPartRenderer:function(n,t){var name=void 0===t?n:t+"."+n,renderer=this.fieldPartRenderers[name];if(void 0!==renderer)return renderer;throw'Fiel part renderer "*" not found'.replace("*",name)},createFormValidator:function(n,d){this.dataValidators[n]=d},validateField:function(n,s,v,p,h){this.dataValidators[n](s,v,p,h)},bindEventHandlers:function(sender){for(var rcount=sender.fieldCount(),i=0;rcount>i;i++){var id=sender.getFieldIdAt(i),type=$("#"+id).data("fieldtype");this.fieldRenderers[type].bindEvents(id,this.emit,sender)}},bindEventHandlersOfField:function(type,id,sender){this.fieldRenderers[type].bindEvents(id,this.emit,sender)},doPosRenderActions:function(sender){var rcount=sender.fieldCount();$("#"+sender.baseID+" .rz-tabpanel .item").tab(),$("#"+sender.baseID+" .ui.accordion").accordion();for(var i=0;rcount>i;i++){var id=sender.getFieldIdAt(i),type=$("#"+id).data("fieldtype");void 0!==this.fieldRenderers[type].doPosRenderActions&&this.fieldRenderers[type].doPosRenderActions(id,sender)}},doPosRenderActionsOfField:function(type,id,sender){void 0!==this.fieldRenderers[type].doPosRenderActions&&this.fieldRenderers[type].doPosRenderActions(id,sender)},getValueOfField:function(id){var fieldType=$(id).data("fieldtype");return this.fieldRenderers[fieldType].getValue?this.fieldRenderers[fieldType].getValue(id+"_"+fieldType):void 0},setValueOfField:function(id,newValue){var fieldType=$(id).data("fieldtype");this.fieldRenderers[fieldType].setValue&&this.fieldRenderers[fieldType].setValue(id+"_"+fieldType,newValue)},emit:function(n,d,sender){var handlers=sender.getEventHandlers();void 0!==handlers[n]&&handlers[n].length>0&&handlers[n].forEach(function(it){it(sender,d)})},validateFormImpl:function($this,params,validationResultHandler,fieldsetRule,forceSuccess){validationResultHandler=rz.helpers.ensureFunction(validationResultHandler);var formData=$this.sender.getFormData(),$that=this;params.validation.enabled?($this.sender.validationReport=[],params.validation.rules.forEach(function(rule){var fieldID=$("#"+$this.target+"base_form .field[data-model='"+rule.model+"']").attr("id");(void 0!==fieldsetRule&&$that.fieldMatchFieldSetRule(fieldID,fieldsetRule)||void 0===fieldsetRule)&&(forceSuccess||rz.widgets.formHelpers.validateField(rule.type,$this.sender,formData[rule.model],rule,function(result,params){result||$this.sender.validationReport.push({failedRule:rule})}))}),$this.sender.isFormInvalid=$this.sender.validationReport.length>0,$this.displayValidationReport(),validationResultHandler($this.sender,{validated:!$this.sender.isFormInvalid})):validationResultHandler($this.sender,{validated:!0})},displayValidationReportImpl:function($this){var fieldsSelector="#* .field".replace("*",$this.target);$(fieldsSelector).removeClass("error");var fieldSelector='#* [data-model="*"]'.replace("*",$this.target),reportTarget=$this.params.validation.reportTarget||"#"+$this.target+"_validation_report";if(void 0!==$this.sender.validationReport&&$this.sender.validationReport.length>0){var sb=new StringBuilder;sb.appendFormat('<div class="ui error message">'),sb.appendFormat('	<ul class="list">'),$this.sender.validationReport.forEach(function(item){sb.appendFormat("<li>{0}</li>",item.failedRule.message),$(fieldSelector.replace("*",item.failedRule.model)).addClass("error")}),sb.appendFormat("	</ul>"),sb.appendFormat("</div>"),$(reportTarget).html(sb.toString())}else $(reportTarget).empty()},getFormDataImpl:function($this,fieldsetRule){for(var root={},rcount=$this.fieldCount(),i=0;rcount>i;i++){var id=$this.getFieldIdAt(i),model=$("#"+id).data("model");void 0!==model&&"***"!=model&&(void 0!==fieldsetRule?this.fieldMatchFieldSetRule(id,fieldsetRule)&&rz.helpers.jsonUtils.setDataAtPath(root,$this.getValueOf(id),model):rz.helpers.jsonUtils.setDataAtPath(root,$this.getValueOf(id),model))}return root},setFormDataImpl:function(formData,$this,fieldsetRule){for(var rcount=$this.fieldCount(),i=0;rcount>i;i++){var id=$this.getFieldIdAt(i);if(void 0!==fieldsetRule&&this.fieldMatchFieldSetRule(id,fieldsetRule)||void 0===fieldsetRule){var model=$("#"+id).data("model");if(void 0!==model&&"***"!=model){var value=rz.helpers.jsonUtils.getDataAtPath(formData,model);$this.setValueOfModel(model,value)}}}},clearFormDataImpl:function($this,fieldsetRule){for(var rcount=$this.fieldCount(),i=0;rcount>i;i++){var id=$this.getFieldIdAt(i);if(void 0!==fieldsetRule&&this.fieldMatchFieldSetRule(id,fieldsetRule)||void 0===fieldsetRule){var initialValue=$("#"+id).data("initial-value");void 0!==initialValue&&null!=initialValue.toString().match(/^object-data:\[.*]$/)&&(initialValue=initialValue.replace(/^object-data:\[/,"").replace(/]$/,""),initialValue=JSON.parse(atob(initialValue))),$this.setValueAt(i,initialValue)}}},resolveFieldSet:function(field){if(void 0!==field.fieldSetName){if(field.fieldSetName.match(/^[a-zA-Z 0-9]+$/)){var fieldSets=field.fieldSetName.split(" "),ret=[];return fieldSets.forEach(function(item){""!==item&&ret.push("-FIELDSET-"+item)}),ret.length>0?" FIELDSET_MEMBER "+ret.join(" "):""}throw"invalid fieldset name"}return""},fieldMatchFieldSetRule:function(fieldID,fieldsetRule){var result="exclude"==fieldsetRule.rule;return fieldsetRule.fieldsets.every(function(item){var fsName="-FIELDSET-"+item;return"exclude"==fieldsetRule.rule?$("#"+fieldID).hasClass(fsName)?(result=!1,!1):!0:"restrict"==fieldsetRule.rule?$("#"+fieldID).hasClass(fsName)?(result=!0,!1):!0:void 0}),result}},rz.widgets.formHelpers.createFieldRenderer("actions",{actionRenderers:{button:function(actionData,sb,containerID){sb.appendFormat('<button id="{3}_action-button" class="ui {2} button rz-action-handler" data-action="{0}">{1}</button>',actionData.name,actionData.label||"",actionData.cssClass||"primary",containerID)}},render:function(sb,field,containerID){var $this=this;return void 0!==field.actions&&field.actions.forEach(function(action){$this.actionRenderers[action.type](action,sb,containerID)}),containerID+"_collection"},bindEvents:function(id,emit,sender){$("#"+id+" .button.rz-action-handler").click(function(e){var action=$(e.currentTarget).data("action");return void 0!==action&&emit(action,{field:id,targetElement:e,action:action,src:"usr"},sender),!1})},doPosRenderActions:function(id,$this){}}),rz.widgets.formHelpers.createFieldRenderer("collection",{getFieldParams:function(id){var pid=id.startsWith("#")?id:"#"+id;return JSON.parse(atob($(pid).data("field-params")))},getContentRenderer:function(params){var contentRenderer=rz.helpers.jsonUtils.getDataAtPath(params,"itemsSource.renderer");return void 0===contentRenderer?rz.widgets.formHelpers.getFieldPartRenderer("default-list","collection"):rz.widgets.formHelpers.getFieldPartRenderer(contentRenderer,"collection")},render:function(sb,field,containerID){return sb.appendFormat('<div class="{0}">',field.maineElementCss||"ui raised secondary segment"),sb.appendFormat('   <div id="{0}_collection_container" class="ui {1} list collection-container">',containerID,field.collectionContainerCssClsss||"middle aligned divided"),sb.appendFormat("   </div>"),sb.appendFormat("</div>"),containerID+"_collection"},getValue:function(id){},setValue:function(id,newValue){var fieldParams=this.getFieldParams(id.substring(0,id.lastIndexOf("_collection"))),sb=new StringBuilder;if(sb.appendFormat('       <div class="item">'),!fieldParams.itemActions.hideActionsMenu){var actionsRenderer=fieldParams.itemActions.renderer||"default";"string"==typeof actionsRenderer&&(actionsRenderer=rz.widgets.formHelpers.getFieldPartRenderer(actionsRenderer,"collection")),actionsRenderer(sb,fieldParams)}sb.appendFormat('           <div class="content">');var contentRenderer=this.getContentRenderer(fieldParams);contentRenderer(sb,fieldParams,newValue),sb.appendFormat("               Lindsay"),sb.appendFormat("           </div>"),sb.appendFormat("       </div>"),sb.appendFormat('<script>$(".ui.dropdown").dropdown()</script>'),$(id+"_collection_container").append(sb.toString())},bindEvents:function(id,emit,sender){var fieldParams=this.getFieldParams(id),fieldsets={rule:"restrict",fieldsets:fieldParams.itemsSource.source.split(" ")};"fieldset"==fieldParams.itemsSource.type&&sender.on(fieldParams.itemsSource.trigger,function(sender){sender.validateForm(function(sender,result){if(result.validated){var newItem=sender.getFormData(fieldsets);sender.clearFormData(fieldsets),sender.setValueOf(id,newItem)}},fieldsets)})},doPosRenderActions:function(id,$this){}}),rz.widgets.formHelpers.createFieldPartRenderer("default-actions",function(sb,params){var ensureActions=function(){void 0===params.itemActions&&(params.itemActions={}),void 0===params.itemActions.actions&&(params.itemActions.actions=[{name:"Delete item",action:"remove-item",icon:"delete"},{name:"Edit item",action:"edit-item",icon:"edit"}])},title=rz.helpers.jsonUtils.getDataAtPath(params,"itemActions.properties.title")||"Actions";ensureActions(),sb.appendFormat('<div class="right floated content">'),sb.appendFormat('    <div class="ui icon top right pointing dropdown button">'),sb.appendFormat('        <i class="ellipsis vertical icon"></i>'),sb.appendFormat('        <div class="menu">'),sb.appendFormat('            <div class="header">{0}</div>',title),params.itemActions.actions.forEach(function(action){sb.appendFormat('            <div class="item"><i class="{0} icon" data-action="{1}"></i> {2}</div>',action.icon,action.action,action.name)}),sb.appendFormat("        </div>"),sb.appendFormat("    </div>"),sb.appendFormat("</div>")},"collection"),rz.widgets.formHelpers.createFieldPartRenderer("default-list",function(sb,params,data){var dmp=rz.helpers.jsonUtils.getDataAtPath(params,"itemsSource.displayMemberPath"),text="";text=void 0!==dmp?void 0!==data?rz.helpers.jsonUtils.getDataAtPath(data,dmp):"":void 0!==data?data.toString():"",sb.appendFormat(text)},"collection"),rz.widgets.formHelpers.createFieldRenderer("list",{activeInstances:{},helpers:{getElementID:function(id,suffix){return void 0===suffix&&(suffix=""),suffix+id+"_list"}},render:function(sb,field,containerID){sb.appendFormat('<select id="{0}" name="{0}" class="form-control">',containerID),field.listItems.forEach(function(it){sb.appendFormat('   <option value="{1}" {2}>{0}</option>',it.label,it.value,it.value==field.value?"selected":"")}),sb.appendFormat("</select>")},getValue:function(id){return $(id).val()},setValue:function(id,newValue){null==newValue?$(id).dropdown("restore default value"):$(id).dropdown("set selected",newValue)},bindEvents:function(id,emit,sender){var id=this.helpers.getElementID(id,"#"),handler=function(id,value,text){emit("data-changed",{fieldid:id,value:value,src:"usr",text:text},sender)};this.activeInstances[id].push(handler)},doPosRenderActions:function(id){var $this=this,elID=this.helpers.getElementID(id,"#");$(elID).dropdown({onChange:function(value,text,$selectedItem){var elInst=$this.activeInstances[elID];void 0!==elInst&&elInst.length>0&&elInst.forEach(function(item){item(elID,value,text)})}}),this.activeInstances[elID]=[]}}),rz.widgets.formHelpers.createFieldRenderer("password",{render:function(sb,field,containerID){var resolveAttributes=function(){var attr=field.attributes;if(void 0===attr||attr.length<=0)return"";var ret=" ";return attr.forEach(function(at){ret+=at.name+'="'+at.value+'" '}),ret};return sb.appendFormat('<input id="{1}" name="{1}" type="password" value="{0}" class="form-control"{2}>',field.value||"",containerID,resolveAttributes()),containerID+"_input_pwd"},getValue:function(id){return $(id).val()},setValue:function(id,newValue){$(id).val(newValue||"")},bindEvents:function(id,emit,sender){$("#"+id).change(function(e){emit("data-changed",{field:id,value:e.target.value,src:"usr"},sender)})},doPosRenderActions:function(id,$this){}}),rz.widgets.formHelpers.createFieldRenderer("text",{render:function(sb,field,containerID){var resolveAttributes=function(){var attr=field.attributes;if(void 0===attr||attr.length<=0)return"";var ret=" ";return attr.forEach(function(at){ret+=at.name+'="'+at.value+'" '}),ret};return sb.appendFormat('<input id="{1}" name="{1}" type="text" value="{0}" class="form-control"{2}>',field.value||"",containerID,resolveAttributes()),containerID+"_input"},getValue:function(id){return $(id).val()},setValue:function(id,newValue){$(id).val(newValue||"")},bindEvents:function(id,emit,sender){$("#"+id).change(function(e){emit("data-changed",{field:id,value:e.target.value,src:"usr"},sender)})},doPosRenderActions:function(id,$this){}}),rz.widgets.FormRenderers["default"]=function(params,sender){var $this=this,initialize=function(){var defaultParams={horizontal:!1,formLabelSizeClass:"col-sm-2",formValueSizeClass:"col-sm-10",validation:{enabled:!0,rules:[]}};$this.params=$.extend(!0,{},defaultParams,params),$this.sender=sender};this.render=function(target,params){$this.params=params,$this.target=target;var baseID=target+"base_form",sb=new StringBuilder;sb.append('<div class="form-widget">'),sb.appendFormat('  <form id="{0}" class="{1} ui form">',baseID,params.horizontal?"form-horizontal":"");var hasTabs=isElegibleFormTabPanel();hasTabs&&renderTabPanels(sb),rz.widgets.formHelpers.renderDataRows(sb,params,renderDataField),sb.append("  </form>"),sb.appendFormat('<div id="{0}_validation_report" class="validation-report-container"></div>',target),sb.append("</div>"),$("#"+target).append(sb.toString()),$this.sender.baseID=baseID,rz.widgets.formHelpers.doPosRenderActions($this.sender),rz.widgets.formHelpers.bindEventHandlers($this.sender)};var isElegibleFormTabPanel=function(){var elegible=!0;return $this.params.fields.forEach(function(it){return it.fieldGroup?void 0:(elegible=!1,null)}),elegible},activeTabIndex=function(){var index=0;return $this.params.fields.forEach(function(it,id){it.active&&(index=id)}),index},renderTabPanels=function(sb){var actidx=activeTabIndex();sb.appendFormat('<div class="ui top attached tabular menu rz-tabpanel">'),$this.params.fields.forEach(function(it,id){var targetID=generateRandomID(12);sb.appendFormat('<a class="item {2}" data-tab="{1}">{0}</a>',it.groupLabel,targetID,id==actidx?"active":""),it.groupID=targetID,it.active=id==actidx}),sb.appendFormat("</div>")},renderCollapseContainer=function(sb,fieldID,field){sb.appendFormat('<div class="ui styled fluid accordion">'),sb.appendFormat('    <div class="active title">'),sb.appendFormat('    <i class="dropdown icon"></i>'),sb.appendFormat("    {0}",field.groupLabel||""),sb.appendFormat("</div>"),sb.appendFormat('<div class="active content">'),field.fields.forEach(function(it){renderDataField(sb,it)}),sb.appendFormat("</div>"),sb.appendFormat("</div>")},renderTabContainer=function(sb,field){sb.appendFormat('<div class="ui bottom attached tab segment {1}" data-tab="{0}">',field.groupID,field.active?"active":""),field.fields.forEach(function(it){renderDataField(sb,it)}),sb.appendFormat("</div>")},renderFieldGroupContainer=function(sb,fieldID,field){var c=["zero","one","two","three","four","five","six","seven","eight","nine","ten","eleven","twelve","thirteen","fourteen","fifteen","sixteen"],fieldCount=field.fields.count;(void 0===fieldCount||fieldCount>16)&&(fieldCount=2);var fieldCountName=field.columCount||c[fieldCount];sb.appendFormat('<div class="{0} fields">',fieldCountName),field.fields.forEach(function(it){renderDataField(sb,it)}),sb.appendFormat("</div>")},renderDataField=function(sb,field){var fieldID=(field.id||field.model||"field_"+generateRandomID(8)).replace(/\./g,"_");if(field.fieldGroup){var groupType=field.groupType||"tabpanel";"tabpanel"==groupType?renderTabContainer(sb,field):"collapse"==groupType?renderCollapseContainer(sb,fieldID,field):"fieldgroup"==groupType&&renderFieldGroupContainer(sb,fieldID,field)}else{var h=$this.params.horizontal;field.type=field.type||"text",field.id="*_*".replace("*",$this.target).replace("*",fieldID),sb.appendFormat('<div id="{0}" data-fieldtype="{1}" data-model="{2}" data-initial-value="{3}" class="form-row {4}{5}{6}" data-field-params="{7}">',field.id,field.type,rz.widgets.formHelpers.resolveModelName(field,fieldID),rz.widgets.formHelpers.getInitialValueData(field),h?"inline fields":"field",void 0!==field.wide?" "+field.wide+" wide":"",rz.widgets.formHelpers.resolveFieldSet(field),btoa(JSON.stringify(field)));var inputID=$this.target+"_"+fieldID+"_"+field.type;h&&sb.appendFormat('<div class="sixteen wide field">'),void 0!==field.label&&sb.appendFormat('<label for="{1}" class="{2}">{0}</label>',field.label,inputID,"control-label"),rz.widgets.formHelpers.renderDataFieldByType(sb,field,inputID,$this),h&&sb.appendFormat("</div>"),sb.append("</div>")}};this.fieldCount=function(){return $("#"+$this.target+"base_form .form-row").length},this.getFieldIdAt=function(position){var p=position;return p>=0&&p<this.fieldCount()?$("#"+$this.target+"base_form .form-row").eq(p).attr("id"):void 0},this.addField=function(fielddata){var sb=new StringBuilder;renderDataField(sb,fielddata),$("#"+$this.target+"base_form .form-row").last().parent().append(sb.toString())},this.insertField=function(fielddata,position){var sb=new StringBuilder;renderDataField(sb,fielddata),$("#"+$this.target+"base_form .form-row").eq(position).before(sb.toString())},this.removeFieldAt=function(position){var p=position;p>=0&&p<this.fieldCount()&&$("#"+$this.target+"base_form .form-row").eq(p).remove()},this.removeFieldById=function(fieldid){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),$("#"+fieldid).remove()},this.getValueAt=function(position){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form .form-row").eq(p).attr("id");return rz.widgets.formHelpers.getValueOfField("#"+id)}},this.getValueOf=function(fieldid){return fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),rz.widgets.formHelpers.getValueOfField("#"+fieldid)},this.getValueOfModel=function(model){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.getValueOf(id)},this.setValueOfModel=function(model,value){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.setValueOf(id,value)},this.setValueAt=function(position,value){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form .form-row").eq(p).attr("id"),formerValue=rz.widgets.formHelpers.getValueOfField("#"+id);formerValue!=value&&(rz.widgets.formHelpers.setValueOfField("#"+id,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:id,value:value,src:"code"},$this.sender))}},this.setValueOf=function(fieldid,value){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid);var formerValue=rz.widgets.formHelpers.getValueOfField("#"+fieldid);formerValue!=value&&(rz.widgets.formHelpers.setValueOfField("#"+fieldid,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:fieldid,value:value,src:"code"},$this.sender))},this.getFormData=function(fieldsetRule){return rz.widgets.formHelpers.getFormDataImpl($this,fieldsetRule)},this.setFormData=function(formData,fieldsetRule){rz.widgets.formHelpers.setFormDataImpl(formData,$this,fieldsetRule)},this.clearFormData=function(fieldsetRule){rz.widgets.formHelpers.clearFormDataImpl($this,fieldsetRule)},this.validateForm=function(validationResultHandler,fieldsetRule,forceSuccess){rz.widgets.formHelpers.validateFormImpl($this,params,validationResultHandler,fieldsetRule,forceSuccess)},this.displayValidationReport=function(){rz.widgets.formHelpers.displayValidationReportImpl($this)},initialize()},rz.widgets.FormRenderers["grid-row"]=function(params,sender){var $this=this,initialize=function(){$this.params=params,$this.sender=sender};this.render=function(target,params){$this.target=target;var sb=new StringBuilder;sb.appendFormat('    <tr id="{0}base_form">',target),rz.widgets.formHelpers.renderDataRows(sb,params,renderDataField),sb.appendFormat("    </tr>"),$("#"+target).append(sb.toString()),rz.widgets.formHelpers.doPosRenderActions($this.sender),rz.widgets.formHelpers.bindEventHandlers($this.sender)};var renderDataField=function(sb,field){var fieldID=(field.id||field.model||"row_"+generateRandomID(8)).replace(/\./g,"_");if(field.fieldGroup)field.fields.forEach(function(it){renderDataField(sb,it)});else{field.type=field.type||"text",field.id="*_*".replace("*",$this.target).replace("*",fieldID),sb.appendFormat('<td id="{0}" data-fieldtype="{1}" data-model="{2}" data-initial-value="{3}" class="row-form-field field{4}" data-field-params="{5}">',field.id,field.type,rz.widgets.formHelpers.resolveModelName(field,fieldID),rz.widgets.formHelpers.getInitialValueData(field),rz.widgets.formHelpers.resolveFieldSet(field),btoa(JSON.stringify(field)));var inputID=$this.target+"_"+fieldID+"_"+field.type;rz.widgets.formHelpers.renderDataFieldByType(sb,field,inputID,$this),sb.append("</td>")}};this.fieldCount=function(){return $("#"+$this.target+"base_form > .row-form-field").length},this.getFieldIdAt=function(position){var p=position;return p>=0&&p<$this.sender.fieldCount()?$("#"+$this.target+"base_form > .row-form-field").eq(p).attr("id"):void 0},this.addField=function(fielddata){var sb=new StringBuilder;renderDataField(sb,fielddata),$(sb.toString()).appendTo("#"+$this.target+"base_form")},this.insertField=function(fielddata,position){var sb=new StringBuilder;renderDataField(sb,fielddata),$("#"+$this.target+"base_form > .row-form-field").eq(position).before(sb.toString())},this.removeFieldAt=function(position){var p=position;p>=0&&p<this.fieldCount()&&$("#"+$this.target+"base_form > .row-form-field").eq(p).remove()},this.removeFieldById=function(fieldid){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),$("#"+fieldid).remove()},this.getValueAt=function(position){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form > .row-form-field").eq(p).attr("id");return rz.widgets.formHelpers.getValueOfField("#"+id)}},this.getValueOfModel=function(model){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.getValueOf(id)},this.setValueOfModel=function(model,value){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.setValueOf(id,value)},this.getValueOf=function(fieldid){return fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),rz.widgets.formHelpers.getValueOfField("#"+fieldid)},this.setValueAt=function(position,value){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form > .row-form-field").eq(p).attr("id");rz.widgets.formHelpers.setValueOfField("#"+id,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:id,value:value,src:"code"},$this.sender)}},this.setValueOf=function(fieldid,value){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),rz.widgets.formHelpers.setValueOfField("#"+fieldid,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:fieldid,value:value,src:"code"},$this.sender)},this.getFormData=function(fieldsetRule){return rz.widgets.formHelpers.getFormDataImpl($this,fieldsetRule)},this.setFormData=function(formData,fieldsetRule){rz.widgets.formHelpers.setFormDataImpl(formData,$this,fieldsetRule)},this.clearFormData=function(fieldsetRule){rz.widgets.formHelpers.clearFormDataImpl($this,fieldsetRule)},this.validateForm=function(validationResultHandler,fieldsetRule,forceSuccess){rz.widgets.formHelpers.validateFormImpl($this,params,validationResultHandler,fieldsetRule,forceSuccess)},this.displayValidationReport=function(){rz.widgets.formHelpers.displayValidationReportImpl($this)},initialize()},rz.widgets.FormRenderers["v-grid"]=function(params,sender){var $this=this,initialize=function(){var defaultParams={displayHeader:!1,headerLabel:"Label",headerValue:"Value"};$this.params=$.extend(!0,{},defaultParams,params),$this.sender=sender};this.render=function(target,params){$this.target=target;var sb=new StringBuilder;sb.append('<div class="grid-form">'),sb.append('<form class="ui form">'),sb.appendFormat('  <table id="{0}base_form" class="ui celled table">',target),renderHeader(sb,params),sb.append("    <tbody>"),rz.widgets.formHelpers.renderDataRows(sb,params,renderDataField),sb.append("    </tbody>"),sb.append("  </table>"),sb.append("</form>"),sb.append("</div>"),$("#"+target).append(sb.toString()),rz.widgets.formHelpers.doPosRenderActions($this.sender),rz.widgets.formHelpers.bindEventHandlers($this.sender),bindCollapseButtonEvents()};var bindCollapseButtonEvents=function(){var fid="#"+$this.target+" .collapse-toggle-button";$(fid).click(function(e){e.preventDefault();var baseRow=$(e.currentTarget).parent().parent(),pid=baseRow.attr("id");baseRow.toggleClass("collapsed");var selector='tr[data-groupingid="*"]'.replace("*",pid);baseRow.hasClass("collapsed")?$(selector).hide():$(selector).show()})},renderHeader=function(sb,params){params.displayHeader&&(sb.append("<thead>"),sb.append("  <tr>"),sb.appendFormat("  <th>{0}</th>",params.headerLabel),sb.appendFormat("  <th>{0}</th>",params.headerValue),sb.append("  </tr>"),sb.append("</thead>"))},renderFieldGroup=function(field,fieldID,sb,parentGroup){if("fieldgroup"!=field.groupType){field.collapsible=void 0===field.collapsible?!0:field.collapsible;var gid="*_*".replace("*",$this.target).replace("*",fieldID);sb.appendFormat('<tr id="{0}" class="vdgrid-group-header">',gid),field.collapsible?sb.appendFormat('<td colspan="2"><a href="#" class="collapse-toggle-button">{0}</a></td>',field.groupLabel):sb.appendFormat('<td colspan="2"><span>{0}</span></td>',field.groupLabel),sb.appendFormat("</tr>");var groupInfoData='data-groupingid="*"'.replace("*",gid);field.fields.forEach(function(it){renderDataField(sb,it,groupInfoData)})}else field.fields.forEach(function(it){renderDataField(sb,it,parentGroup)})},renderDataField=function(sb,field,gidata){var fieldID=(field.id||field.model||"row_"+generateRandomID(8)).replace(/\./g,"_");if(field.fieldGroup)renderFieldGroup(field,fieldID,sb,gidata);else{field.type=field.type||"text",field.id="*_*".replace("*",$this.target).replace("*",fieldID),sb.appendFormat('<tr id="{0}" data-fieldtype="{1}" data-model="{2}" data-initial-value="{3}" {4} class="field field-row{5}" data-field-params="{6}">',field.id,field.type,rz.widgets.formHelpers.resolveModelName(field,fieldID),rz.widgets.formHelpers.getInitialValueData(field),gidata||"",rz.widgets.formHelpers.resolveFieldSet(field),btoa(JSON.stringify(field)));var inputID=$this.target+"_"+fieldID+"_"+field.type;sb.appendFormat('<td><label for="{1}">{0}</label></td>',field.label,inputID),sb.appendFormat("<td>"),rz.widgets.formHelpers.renderDataFieldByType(sb,field,inputID,$this),sb.append("</td>"),sb.append("</tr>")}};this.fieldCount=function(){return $("#"+$this.target+"base_form tbody > .field-row").length},this.getFieldIdAt=function(position){var p=position;return p>=0&&p<$this.sender.fieldCount()?$("#"+$this.target+"base_form tbody > .field-row").eq(p).attr("id"):void 0},this.addField=function(fielddata){var sb=new StringBuilder;renderDataField(sb,fielddata),$(sb.toString()).appendTo("#"+$this.target+"base_form tbody")},this.insertField=function(fielddata,position){var sb=new StringBuilder;renderDataField(sb,fielddata),$("#"+$this.target+"base_form tbody > .field-row").eq(position).before(sb.toString())},this.removeFieldAt=function(position){var p=position;p>=0&&p<this.fieldCount()&&$("#"+$this.target+"base_form tbody > .field-row").eq(p).remove()},this.removeFieldById=function(fieldid){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),$("#"+fieldid).remove()},this.getValueAt=function(position){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form tbody > .field-row").eq(p).attr("id");return rz.widgets.formHelpers.getValueOfField("#"+id)}},this.getValueOfModel=function(model){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.getValueOf(id)},this.setValueOfModel=function(model,value){var id=$("#"+$this.target+"base_form .field[data-model='"+model+"']").attr("id");return $this.setValueOf(id,value)},this.getValueOf=function(fieldid){return fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),rz.widgets.formHelpers.getValueOfField("#"+fieldid)},this.setValueAt=function(position,value){var p=position;if(p>=0&&p<this.fieldCount()){var id=$("#"+$this.target+"base_form tbody > .field-row").eq(p).attr("id");rz.widgets.formHelpers.setValueOfField("#"+id,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:id,value:value,src:"code"},$this.sender)}},this.setValueOf=function(fieldid,value){fieldid.startsWith($this.target+"_")||(fieldid=$this.target+"_"+fieldid),rz.widgets.formHelpers.setValueOfField("#"+fieldid,value),rz.widgets.formHelpers.emit("data-changed",{fieldid:fieldid,value:value,src:"code"},$this.sender)},this.getFormData=function(fieldsetRule){return rz.widgets.formHelpers.getFormDataImpl($this,fieldsetRule)},this.setFormData=function(formData,fieldsetRule){rz.widgets.formHelpers.setFormDataImpl(formData,$this,fieldsetRule)},this.clearFormData=function(fieldsetRule){rz.widgets.formHelpers.clearFormDataImpl($this,fieldsetRule)},this.validateForm=function(validationResultHandler,fieldsetRule,forceSuccess){rz.widgets.formHelpers.validateFormImpl($this,params,validationResultHandler,fieldsetRule,forceSuccess)},this.displayValidationReport=function(){rz.widgets.formHelpers.displayValidationReportImpl($this)},initialize()},rz.widgets.formHelpers.createFormValidator("compare",function(sender,value,validationParams,validationHandler){var resolveType=function(v,tp){if(void 0===v||null==v)return v;switch(tp){case"number":return parseFloat(v);case"date":return new Date(v);case"text":return v.toString();default:return v}},callback=rz.helpers.ensureFunction(validationHandler),operations={},op=validationParams.operator||"==",tp=validationParams.valueType||"text",vA=resolveType(value,tp),vB=resolveType(sender.getValueOfModel(validationParams.modelToCompare),tp);operations["=="]=function(a,b){return a==b},operations["==="]=function(a,b){
return a===b},operations["!="]=function(a,b){return a!=b},operations["!=="]=function(a,b){return a!==b},operations[">"]=function(a,b){return a>b},operations[">="]=function(a,b){return a>=b},operations["<"]=function(a,b){return b>a},operations["<="]=function(a,b){return b>=a},callback(operations[op](vA,vB))}),rz.widgets.formHelpers.createFormValidator("custom",function(sender,value,validationParams,validationHandler){var callback=rz.helpers.ensureFunction(validationHandler);void 0!==validationParams.validationFunction?validationParams.validationFunction(sender,value,callback,validationParams):(console.warn("validation function not defined. Validation bypassed"),validationHandler(!0))}),rz.widgets.formHelpers.createFormValidator("range",function(sender,value,validationParams,validationHandler){var callback=rz.helpers.ensureFunction(validationHandler);if("number"==validationParams.valueType)if(void 0==value||""==value||null==value)callback(!0);else{var cVal=parseFloat(value),vmin=void 0!==validationParams.minValue?cVal>=validationParams.minValue:!0,vmax=void 0!==validationParams.maxValue?cVal<=validationParams.maxValue:!0;callback(vmin&&vmax)}}),rz.widgets.formHelpers.createFormValidator("regex",function(sender,value,validationParams,validationHandler){var validateEmptyValues=1==validationParams.validateEmptyValues;if(void 0==value||null==value||""==value&&!validateEmptyValues)validationHandler(!0);else{var result=value.toString().match(validationParams.regularExpression);validationHandler(null!=result&&0!=result.length)}}),rz.widgets.formHelpers.createFormValidator("required",function(sender,value,validationParams,validationHandler){var allowEmpty=1==validationParams.allowEmpty,callback=rz.helpers.ensureFunction(validationHandler);void 0==value||null==value||""==value&&!allowEmpty?callback(!1,validationParams):callback(!0,validationParams)}),rz.widgets.FormWidget=ruteZangada.widget("Form",rz.widgets.RZFormWidgetHelpers.FormWidgetInterface,rz.widgets.RZFormWidgetHelpers.FormWidgetEventHandlers,function(){var $this=this;this.validationReport=[],$this.lastFieldsetRules=void 0,this.initialize=function(params,initialized){var renderer=params.renderer||"default";$this.renderer=new rz.widgets.FormRenderers[renderer](params,$this),$this.on("data-changed",function(sender,e){updateValidationStatus()}),initialized($this.renderer.params)};var updateValidationStatus=function(){$this.isFormInvalid&&$this.validateForm(void 0,$this.lastFieldsetRules)};this.render=function(target,params){$this.renderer.render(target,params)},this.fieldCount=function(){return $this.renderer.fieldCount()},this.getFieldIdAt=function(position){return $this.renderer.getFieldIdAt(position)},this.addField=function(fielddata){$this.renderer.addField(fielddata),rz.widgets.formHelpers.bindEventHandlersOfField(fielddata.type,fielddata.id,$this),rz.widgets.formHelpers.doPosRenderActionsOfField(fielddata.type,fielddata.id,$this),$this.raiseEvent("field-added",fielddata,$this)},this.insertField=function(fielddata,position){$this.renderer.insertField(fielddata,position),rz.widgets.formHelpers.bindEventHandlersOfField(fielddata.type,fielddata.id,$this),rz.widgets.formHelpers.doPosRenderActionsOfField(fielddata.type,fielddata.id,$this)},this.removeFieldAt=function(position){$this.renderer.removeFieldAt(position)},this.removeFieldById=function(fieldid){$this.renderer.removeFieldById(fieldid)},this.getValueAt=function(position){return $this.renderer.getValueAt(position)},this.getValueOf=function(fieldid){return $this.renderer.getValueOf(fieldid)},this.setValueAt=function(position,value){$this.renderer.setValueAt(position,value)},this.setValueOf=function(fieldid,value){$this.renderer.setValueOf(fieldid,value)},this.getValueOfModel=function(model){return $this.renderer.getValueOfModel(model)},this.setValueOfModel=function(model,value){return $this.renderer.setValueOfModel(model,value)},this.getFormData=function(fieldsetRule){return $this.renderer.getFormData(fieldsetRule)},this.setFormData=function(formData,fieldsetRule){$this.lastFieldsetRules=fieldsetRule,$this.renderer.setFormData(formData,fieldsetRule)},this.clearFormData=function(fieldsetRule,preserveValidationStatus){preserveValidationStatus||$this.renderer.validateForm(void 0,void 0,!0),$this.lastFieldsetRules=fieldsetRule,$this.renderer.clearFormData(fieldsetRule)},this.validateForm=function(validationResultHandler,fieldsetRule){$this.lastFieldsetRules=fieldsetRule,$this.renderer.validateForm(validationResultHandler,fieldsetRule)}});